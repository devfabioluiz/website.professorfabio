<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aula 2 - Promises</title>
    <link rel="stylesheet" href="../../estilos/estilos-aulas.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
    />
  </head>
  <body>
    <header>
      <h1>Aula 2</h1>
      <h4 class="text-center">JavaScript Avan√ßado</h4>
      <h4 class="text-center">Promises</h4>
    </header>
    <main class="container">

    <!-- Promise -->
      <h2>Defini√ß√£o de Promise</h2>
      <section>
        <p>
          Uma <code>Promise</code> √© um objeto que representa uma opera√ß√£o que pode:
        </p>
        <ul>
          <li><b>Pendente</b> - ainda em execu√ß√£o.</li>
          <li><b>Resolvida</b> - conclu√≠da com sucesso.</li>
          <li><b>Rejeitada</b> - conclu√≠da com erro.</li>
        </ul>

        <h4>O que √© uma Promise?</h4>
        <p>
          √â como uma ‚Äúpromessa da vida real‚Äù: algo que pode dar certo ou errado no futuro.
        </p>

        <h5>Exemplo 1</h5>
        <div class="code-container">
          <pre><code class="language-javascript">
let promessa = new Promise((resolve, reject) => {
  let sucesso = true;
  if (sucesso) {
    resolve("üéâ Deu certo!");
  } else {
    reject("‚ùå Algo deu errado!");
  }
});

promessa.then(msg => console.log(msg));
</code></pre>
          <button class="btn-copy">Copiar C√≥digo</button>
        </div>

        <h4>Como criar uma Promise</h4>
        <h5>Exemplo 2</h5>
        <div class="code-container">
          <pre><code class="language-javascript">
function esperar(ms) {
  return new Promise(resolve => {
    setTimeout(() => resolve("‚è≥ Espera conclu√≠da"), ms);
  });
}

esperar(2000).then(msg => console.log(msg));
</code></pre>
          <button class="btn-copy">Copiar C√≥digo</button>
        </div>

        <h4>Usando then e catch</h4>
        <h5>Exemplo 3</h5>
        <div class="code-container">
          <pre><code class="language-javascript">
let promessa2 = new Promise((resolve, reject) => {
  let numero = Math.random();
  if (numero > 0.5) resolve("N√∫mero aceito: " + numero);
  else reject("N√∫mero muito baixo: " + numero);
});

promessa2
  .then(msg => console.log("‚úÖ", msg))
  .catch(erro => console.log("‚ö†Ô∏è", erro));
</code></pre>
          <button class="btn-copy">Copiar C√≥digo</button>
        </div>
      </section>

      <!-- resolve e reject -->
      <h2>Resolve e Reject</h2>
      <section>
        <p>
          Dentro de uma <code>Promise</code>, usamos duas fun√ß√µes:
        </p>
        <ul>
          <li><code>resolve(valor)</code> ‚Üí indica que a opera√ß√£o foi conclu√≠da com sucesso.</li>
          <li><code>reject(erro)</code> ‚Üí indica que a opera√ß√£o falhou.</li>
        </ul>

        <h5>Exemplo 1</h5>
        <div class="code-container">
          <pre><code class="language-javascript">
let promessa = new Promise((resolve, reject) => {
  let sucesso = true;
  if (sucesso) resolve("‚úÖ Deu certo!");
  else reject("‚ùå Algo deu errado!");
});

promessa.then(console.log).catch(console.error);
</code></pre>
          <button class="btn-copy">Copiar C√≥digo</button>
        </div>

        <h5>Exemplo 2</h5>
        <div class="code-container">
          <pre><code class="language-javascript">
function verificarNumero(n) {
  return new Promise((resolve, reject) => {
    if (n > 10) resolve("Maior que 10");
    else reject("Menor ou igual a 10");
  });
}

verificarNumero(15).then(console.log).catch(console.error);
</code></pre>
          <button class="btn-copy">Copiar C√≥digo</button>
        </div>

        <h5>Exemplo 3</h5>
        <div class="code-container">
          <pre><code class="language-javascript">
function dividir(a, b) {
  return new Promise((resolve, reject) => {
    if (b === 0) reject("‚ùå Divis√£o por zero!");
    else resolve(a / b);
  });
}

dividir(10, 2).then(console.log).catch(console.error);
</code></pre>
          <button class="btn-copy">Copiar C√≥digo</button>
        </div>
      </section>

      <!-- finally -->
      <h2>Finally</h2>
      <section>
        <p>
          O <code>finally()</code> √© sempre executado, independente se a Promise foi resolvida ou rejeitada.
          √â √∫til para liberar recursos, fechar conex√µes ou exibir mensagens finais.
        </p>

        <h5>Exemplo 1</h5>
        <div class="code-container">
          <pre><code class="language-javascript">
new Promise((resolve, reject) => {
  resolve("‚úÖ Sucesso!");
})
.then(console.log)
.catch(console.error)
.finally(() => console.log("Finalizado!"));
</code></pre>
          <button class="btn-copy">Copiar C√≥digo</button>
        </div>

        <h5>Exemplo 2</h5>
        <div class="code-container">
          <pre><code class="language-javascript">
new Promise((resolve, reject) => {
  reject("‚ùå Ocorreu um erro");
})
.then(console.log)
.catch(console.error)
.finally(() => console.log("Liberando recursos..."));
</code></pre>
          <button class="btn-copy">Copiar C√≥digo</button>
        </div>

        <h5>Exemplo 3</h5>
        <div class="code-container">
          <pre><code class="language-javascript">
function simularRequisicao() {
  return new Promise((resolve, reject) => {
    setTimeout(() => reject("Servidor indispon√≠vel"), 1500);
  });
}

simularRequisicao()
  .then(console.log)
  .catch(console.error)
  .finally(() => console.log("‚è≥ Tentativa conclu√≠da"));
</code></pre>
          <button class="btn-copy">Copiar C√≥digo</button>
        </div>
      </section>

      <!-- Promise.all -->
      <h2>Promise.all()</h2>
      <section>
        <p>
          O <code>Promise.all()</code> executa v√°rias Promises em paralelo e s√≥ resolve quando <b>todas</b> s√£o conclu√≠das com sucesso.
          Se alguma falhar, ele rejeita tudo.
        </p>

        <h5>Exemplo 1</h5>
        <div class="code-container">
          <pre><code class="language-javascript">
Promise.all([
  Promise.resolve("üçé Ma√ß√£"),
  Promise.resolve("üçå Banana"),
  Promise.resolve("üçá Uva")
]).then(console.log);
</code></pre>
          <button class="btn-copy">Copiar C√≥digo</button>
        </div>

        <h5>Exemplo 2 (com falha)</h5>
        <div class="code-container">
          <pre><code class="language-javascript">
Promise.all([
  Promise.resolve("‚úÖ Ok 1"),
  Promise.reject("‚ùå Falhou!"),
  Promise.resolve("‚úÖ Ok 2")
])
.then(console.log)
.catch(console.error);
</code></pre>
          <button class="btn-copy">Copiar C√≥digo</button>
        </div>

        <h5>Exemplo 3 (simula√ß√£o de requisi√ß√µes)</h5>
        <div class="code-container">
          <pre><code class="language-javascript">
function esperar(ms, msg) {
  return new Promise(resolve => setTimeout(() => resolve(msg), ms));
}

Promise.all([
  esperar(1000, "üì¶ Produto"),
  esperar(2000, "üöö Entrega"),
  esperar(1500, "üí≥ Pagamento")
]).then(console.log);
</code></pre>
          <button class="btn-copy">Copiar C√≥digo</button>
        </div>
      </section>

      <!-- Promise.allSettled -->
      <h2>Promise.allSettled()</h2>
      <section>
        <p>
          Diferente do <code>all()</code>, o <code>allSettled()</code> espera todas as Promises terminarem, 
          seja com sucesso ou erro, e retorna o status de cada uma.
        </p>

        <h5>Exemplo 1</h5>
        <div class="code-container">
          <pre><code class="language-javascript">
Promise.allSettled([
  Promise.resolve("‚úÖ Sucesso"),
  Promise.reject("‚ùå Erro"),
])
.then(console.log);
</code></pre>
          <button class="btn-copy">Copiar C√≥digo</button>
        </div>
      </section>

      <!-- Promise.race -->
      <h2>Promise.race()</h2>
      <section>
        <p>
          O <code>Promise.race()</code> retorna a <b>primeira</b> Promise que finalizar (sucesso ou erro).
        </p>

        <h5>Exemplo 1</h5>
        <div class="code-container">
          <pre><code class="language-javascript">
Promise.race([
  new Promise(res => setTimeout(() => res("‚è∞ 1s"), 1000)),
  new Promise(res => setTimeout(() => res("‚è∞ 2s"), 2000)),
])
.then(console.log);
</code></pre>
          <button class="btn-copy">Copiar C√≥digo</button>
        </div>
      </section>

      <!-- Promise.any -->
      <h2>Promise.any()</h2>
      <section>
        <p>
          O <code>Promise.any()</code> retorna a primeira Promise que for <b>resolvida com sucesso</b>.
          Se todas falharem, gera um erro.
        </p>

        <h5>Exemplo 1</h5>
        <div class="code-container">
          <pre><code class="language-javascript">
Promise.any([
  Promise.reject("‚ùå Erro 1"),
  Promise.reject("‚ùå Erro 2"),
  Promise.resolve("‚úÖ Sucesso na terceira!")
])
.then(console.log)
.catch(console.error);
</code></pre>
          <button class="btn-copy">Copiar C√≥digo</button>
        </div>
      </section>

    </main>
    <footer>
      <div class="button-container">
        <button class="btn-print" onclick="window.print()">Imprimir</button>
      </div>
      <div class="button-container">
        <a class="btn-indice" href="../indice-step.html">Ir para o √≠ndice</a>
      </div>
    </footer>
    <script src="../../scripts/copy-clipboard.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  </body>
</html>
